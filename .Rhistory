#hjust = c(-0.3,-0.5,-0.35),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.3,-0.3,-0.3),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.5,0,0),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(0,0,0),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.1,0,0),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,0,0),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,0.1,0.1),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.1,-0.1),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = -0.2,
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.3,-0.3),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.4,-0.4),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.5,-0.5),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'bottom',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 600, pointsize = 30)
## old style PLOT
pd <- position_dodge(0.1)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(0.1,0.1,2,0.1, "cm"))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(0.1,0.1,2,0.1, "cm"))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm"))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) #%>%
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 1,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) #%>%
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) #%>%
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,0.1,0.1,0.1, "cm")) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(5,0.1,0.1,0.1, "cm")) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) +
theme(plot.margin = margin(2,2,2,2, "cm")) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(2,2,2,2, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(2,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 0,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,-1),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(1,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(1.5,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1.1),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1.2),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1.5),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(1.5,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
g2 <- ggplot(data = data_long, aes(y = pos, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(1.5,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE, col='black') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20),
plot.margin = margin(1.5,0.1,0.1,0.1, "cm"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = c(0,0,1.5),
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"),
font.label = c(size = 24),
hjust = c(-0.2,-0.55,-0.45),
vjust = 1.5,
ncol = 3, nrow = 1,
legend = 'right',
common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
setwd('/Users/juusu53/Documents/projects/kipupotilaat/')
source('./code/helper_functions_for_r_analysis.R')
library(tidyverse)
library(ggsignif)
library(rcompanion)
subs <- read.csv('data/all_pain_patients_with_activations_19_10_2020.csv',
na.strings = 'NaN')
subs$batch <- 'patient'
subs_control <- read.csv('data/matched_controls_with_activations_18_11_2020.csv',
na.strings = 'NaN')
subs_control$batch <- 'control'
subs_fixed <- make_total_colouring_columns(subs) %>% rename_emotions()
subs_control_fixed <- make_total_colouring_columns(subs_control) %>% rename_emotions()
subs_all_big <- subs_fixed %>%bind_rows(subs_control_fixed)
## total pixels
data_long <- subs_all_big %>%
select(subid, sex, batch, pain_0_pos_color:sensitivity_2_pos_color)  %>%
rename(current = pain_0_pos_color, chronic = pain_1_pos_color,
tactile = sensitivity_0_pos_color, pain = sensitivity_1_pos_color,
hedonic = sensitivity_2_pos_color) %>%
mutate(subid = factor(subid), batch = factor(batch)) %>%
rename(group = batch)
## pain plot
u_chronic <- wilcox.test(data_long$chronic ~ data_long$group, conf.int=TRUE)
effect_chronic <- wilcoxonR(x = data_long$chronic,
g = data_long$group)
u_current <- wilcox.test(data_long$current ~ data_long$group, conf.int=TRUE)
effect_current <- wilcoxonR(x = data_long$current,
g = data_long$group)
p_pain <- p.adjust(c(u_current$p.value, u_chronic$p.value))
data_long %>% pivot_longer(current:chronic, names_to='pain type', values_to='prop_coloured') %>%
mutate(`pain type` = factor(`pain type`, levels=c('current', 'chronic'))) %>%
ggplot(aes(x=`pain type`, y=prop_coloured, col=group)) +
geom_boxplot(notch=TRUE, outlier.color='black') +
ylab('proprtion of body coloured') +
geom_jitter(position=position_jitterdodge(), alpha=0.6) +
geom_signif(y_position = c(0.6, 0.6), xmin = c(0.8, 1.8), xmax = c(1.2, 2.2),
annotation = round(p_pain,2), col='black', tip_length=0.0, textsize = 5) +
theme_classic() +
theme(text = element_text(size=20),
axis.text = element_text(size=20))
## sensitivity plot
u_tactile <- wilcox.test(data_long$tactile ~ data_long$group, conf.int=TRUE)
effect_tactile <- wilcoxonR(x = data_long$tactile,
g = data_long$group)
u_pain <- wilcox.test(data_long$pain ~ data_long$group, conf.int=TRUE)
effect_pain <- wilcoxonR(x = data_long$pain,
g = data_long$group)
u_hedonic <- wilcox.test(data_long$hedonic ~ data_long$group)
effect_hedonic <- wilcoxonR(x = data_long$hedonic,
g = data_long$group, ci=TRUE)
pvals <- p.adjust(c(u_tactile$p.value, u_pain$p.value, u_hedonic$p.value))
data_long %>% pivot_longer(tactile:hedonic, names_to='sensitivity type', values_to='prop_coloured') %>%
mutate(`sensitivity type` = factor(`sensitivity type`, levels=c('tactile', 'pain', 'hedonic'))) %>%
ggplot(aes(x=`sensitivity type`, y=prop_coloured, col=group)) +
geom_boxplot(notch=TRUE, outlier.color='black') +
ylab('proprtion of body coloured') +
geom_jitter(position=position_jitterdodge(), alpha=0.6) +
geom_signif(y_position = c(1.1, 1.1, 1.1), xmin = c(0.8, 1.8, 2.8), xmax = c(1.2, 2.2, 3.2),
annotation = round(pvals,2), col='black', tip_length=0.0, textsize = 5) +
theme_classic() +
theme(text = element_text(size=20),
axis.text = element_text(size=20))
subs <- read.csv('data/all_pain_patients_with_activations_by_roi_01_2021.csv',
na.strings = 'NaN')
subs$batch <- 'patient'
View(subs)
colnames(subsw)
colnames(subs)
