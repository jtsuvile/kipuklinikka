axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') +
geom_text(data=dat_text, x=-1, y= 1.2, label=label)
dat_text <- data.frame(
labels = c("A", "B", "C"),
type   = c('pos', 'neg', 'total')
)
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') +
geom_text(data=dat_text, x=-1, y= 1.2, label=labels)
dat_text <- data.frame(
group = c('patient','patient','patienr')
labels = c("A", "B", "C"),
type   = c('pos', 'neg', 'total')
)
dat_text <- data.frame(
group = c('patient','patient','patient')
labels = c("A", "B", "C"),
type   = c('pos', 'neg', 'total')
)
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') +
geom_text(data=dat_text, x=-1, y= 1.2, label=labels)
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') #+
dat_text <- data.frame(
group = c('patient','patient','patient'),
labels = c("A", "B", "C"),
type   = c('pos', 'neg', 'total')
)
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') +
geom_text(data=dat_text, x=-1, y= 1.2, label=labels)
summary_all <- rbind(summarized_neg, summarized_pos, summarized_total) %>%
mutate(type = factor(type, levels = c('pos', 'neg', 'total'), labels = c('A Activations', 'B Deactivations', 'C Combined activations\nand deactivations')))
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') #+
data_extra_long <- data_long %>% pivot_longer(cols=c(pos, neg, total),names_to='type', values_to='Proportion colored') %>%
mutate(type = factor(type, levels = c('pos', 'neg', 'total'), labels = c('A Activations', 'B Deactivations', 'C Combined activations\nand deactivations')))
summarized_neg <- summarized_neg %>% mutate(type= 'neg')
summarized_pos <- summarized_pos %>% mutate(type='pos')
summarized_total <- summarized_total %>% mutate(type='total')
summary_all <- rbind(summarized_neg, summarized_pos, summarized_total) %>%
mutate(type = factor(type, levels = c('pos', 'neg', 'total'), labels = c('A Activations', 'B Deactivations', 'C Combined activations\nand deactivations')))
dat_text <- data.frame(
group = c('patient','patient','patient'),
labels = c("A", "B", "C"),
type   = c('pos', 'neg', 'total')
)
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured') #+
ggplot(data=summary_all, aes(x=emotion, y=coloured, colour=group, group=group)) +
geom_point(data=data_extra_long,aes(x=emotion, y=`Proportion colored`,  colour=group, group=group), position = pjd, size = .9, alpha = 0.5) +
geom_errorbar(aes(ymin=coloured-se, ymax=coloured+se), color='black',width=.2, position=pd) +
geom_point(position=pd, size=2) +
geom_line(position=pd, size=2) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
theme_classic() +
facet_wrap(~type) +
theme(text = element_text(size=20),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position='bottom',
strip.background = element_blank(),
strip.text = element_text(hjust = 0)) +
coord_fixed(ratio=7) +
theme(plot.margin = margin(1,0.1,0.1,0.1, "cm")) +
labs(color = "Group", y = 'Proportion coloured')
ggsave('/Users/juusu53/Documents/projects/kipupotilaat/figures/helsinki_manuscript_figs/n_colored_pixels_act_deact_combo.pdf',
width=300, height = 150, units = 'mm', limitsize=FALSE)
rm(list = ls())
library(psych)
library(stats)
library(corrplot)
library(RColorBrewer)
#library(Hmisc)
library(tidyverse)
library(cocor)
location <- '/Users/juusu53/Documents/projects/kipupotilaat/data/'
subs <- read_csv(paste(location, 'matched_controls_with_activations_18_11_2020.csv', sep='')) %>%
select(age, feels_pain, pain_0_pos_color, pain_1_pos_color,
sensitivity_0_pos_color, sensitivity_1_pos_color, sensitivity_2_pos_color,
feels_anxiety, feels_depression, feels_sad,
feels_happy, feels_angry, feels_fear,feels_surprise, feels_disgust) %>%
rename(current_pain = pain_0_pos_color,
chronic_pain = pain_1_pos_color,
tactile_sensitivity = sensitivity_0_pos_color,
nociceptive_sensitivity = sensitivity_1_pos_color,
hedonic_sensitivity = sensitivity_2_pos_color)
pain_duration <- read_csv2(paste(location, 'pain_start_helsinki_summer2019.csv', sep=''))
subs_pain <- read_csv(paste(location, 'all_pain_patients_with_activations_19_10_2020.csv', sep='')) %>%
select(subid, age, feels_pain, pain_0_pos_color, pain_1_pos_color,
sensitivity_0_pos_color, sensitivity_1_pos_color, sensitivity_2_pos_color,
feels_anxiety, feels_depression, feels_sad,
feels_happy, feels_angry, feels_fear,feels_surprise, feels_disgust) %>%
merge(pain_duration, by="subid", all.x=TRUE) %>%
rename(current_pain = pain_0_pos_color,
chronic_pain = pain_1_pos_color,
tactile_sensitivity = sensitivity_0_pos_color,
nociceptive_sensitivity = sensitivity_1_pos_color,
hedonic_sensitivity = sensitivity_2_pos_color) %>%
rename_with(str_replace,
starts_with('feels'),
pattern = 'feels',
replacement = 'rating') %>%
select(-subid)
correlations <- corr.test(subs_pain)
color_palette <- brewer.pal(n = 11, name = "RdBu")
View(correlations)
View(subs_pain)
library(tidyverse)
library(PupillometryR)
setwd('/Users/juusu53/Documents/projects/kipupotilaat/')
source('/Users/juusu53/Documents/projects/kipupotilaat/code/helper_functions_for_r_analysis.R')
subs <- read.csv('data/all_pain_patients_with_activations_by_roi_01_2021.csv',
na.strings = 'NaN')
subs$group <- 'patient'
subs_control <- read.csv('data/matched_controls_with_activations_by_roi_01_2021.csv',
na.strings = 'NaN')
subs_control$group <- 'control'
#massage data into tidy
subs_all <- subs %>%  select(subid, group, sex, age, emotions_0_head_pos_color:sensitivity_2_feet_pos_color) %>%
bind_rows(subs_control %>% select(subid, sex, age, emotions_0_head_pos_color:group))
subs_all <- rename_emotions(subs_all)
subs_all <- rename_sensitivity(subs_all)
subs_all <- rename_pain(subs_all)
subs_tidy <- subs_all %>% pivot_longer(sadness_head_pos_color:hedonic_feet_pos_color, names_to="task", values_to="prop_coloured") %>%
mutate(task = str_replace(task, 'upper_torso', 'uppertorso'),
task = str_replace(task, 'lower_torso', 'lowertorso')) %>%
separate(task, into=c('condition','area','direction',NA)) %>%
pivot_wider(names_from = direction, values_from = prop_coloured)  %>%
mutate(area = factor(area,
levels=c('head','shoulders','arms','hands', 'uppertorso','lowertorso','legs','feet'),
labels=c('head','shoulders', 'arms','hands', 'upper torso','lower torso','legs','feet')))
pain_full <- subs_tidy %>%  filter(condition %in% c('currpain', 'chronpain')) %>%
mutate(condition = factor(condition, levels=c('currpain','chronpain'), labels = c('current', 'chronic'))) %>%
select(-c(neg, total))
pain_summary <- pain_full %>% group_by(condition, area, group) %>% summarise(mean = mean(pos, na.rm=T),
sd = sd(pos, na.rm=T),
num_obs = sum(!is.na(pos))) %>%
mutate(se = sd/sqrt(num_obs))
pd = position_dodge(width=0.4)
library(tidyverse)
library(PupillometryR)
setwd('/Users/juusu53/Documents/projects/kipupotilaat/')
source('/Users/juusu53/Documents/projects/kipupotilaat/code/helper_functions_for_r_analysis.R')
subs <- read.csv('data/all_pain_patients_with_activations_by_roi_01_2021.csv',
na.strings = 'NaN')
subs$group <- 'patient'
subs_control <- read.csv('data/matched_controls_with_activations_by_roi_01_2021.csv',
na.strings = 'NaN')
subs_control$group <- 'control'
#massage data into tidy
subs_all <- subs %>%  select(subid, group, sex, age, emotions_0_head_pos_color:sensitivity_2_feet_pos_color) %>%
bind_rows(subs_control %>% select(subid, sex, age, emotions_0_head_pos_color:group))
subs_all <- rename_emotions(subs_all)
subs_all <- rename_sensitivity(subs_all)
subs_all <- rename_pain(subs_all)
subs_tidy <- subs_all %>% pivot_longer(sadness_head_pos_color:hedonic_feet_pos_color, names_to="task", values_to="prop_coloured") %>%
mutate(task = str_replace(task, 'upper_torso', 'uppertorso'),
task = str_replace(task, 'lower_torso', 'lowertorso')) %>%
separate(task, into=c('condition','area','direction',NA)) %>%
pivot_wider(names_from = direction, values_from = prop_coloured)  %>%
mutate(area = factor(area,
levels=c('head','shoulders','arms','hands', 'uppertorso','lowertorso','legs','feet'),
labels=c('head','shoulders', 'arms','hands', 'upper torso','lower torso','legs','feet')))
pain_full <- subs_tidy %>%  filter(condition %in% c('currpain', 'chronpain')) %>%
mutate(condition = factor(condition, levels=c('currpain','chronpain'), labels = c('current', 'chronic'))) %>%
select(-c(neg, total))
pain_summary <- pain_full %>% group_by(condition, area, group) %>% summarise(mean = mean(pos, na.rm=T),
sd = sd(pos, na.rm=T),
num_obs = sum(!is.na(pos))) %>%
mutate(se = sd/sqrt(num_obs))
pd = position_dodge(width=0.4)
pain_summary %>%
ggplot(aes(x=area, y=mean, col=group, fill=group, group=group)) +
geom_jitter(data=pain_full, aes(x=area, y=pos, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_point(position = pd, size=3) +
geom_line(position=pd, size=2)+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), color='black',
position=pd, width=.2) +
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~condition, nrow=1) +
theme_minimal() +
theme(text = element_text(size=20),
axis.text.x = element_text(angle=45, hjust=0.8))
## visualise emotions
emo_full <- subs_tidy %>% filter(condition %in% c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')) %>%
mutate(condition = factor(condition, levels=c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')))
emo_summary <- emo_full %>% group_by(condition, area, group) %>% summarise(mean_pos = mean(pos, na.rm=T),
sd_pos = sd(pos, na.rm=T),
mean_neg = mean(neg, na.rm=T),
sd_neg = sd(neg, na.rm=T),
mean_total = mean(total, na.rm=T),
sd_total = sd(total, na.rm=T),
num_obs = sum(!is.na(total))) %>%
mutate(se_pos = sd_pos/sqrt(num_obs),
se_neg = sd_neg/sqrt(num_obs),
se_total = sd_total/sqrt(num_obs))
emo_summary %>%
ggplot(aes(x=area, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=area, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~condition, nrow=2) +
theme_minimal() +
theme(text = element_text(size=20),
axis.text.x = element_text(angle=45, hjust=0.8))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_minimal() +
theme(text = element_text(size=20),
axis.text.x = element_text(angle=45, hjust=0.8))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
axis.text.x = element_text(angle=45, hjust=0.8),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
axis.text.x = element_text(angle=45, hjust=0.8),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.position='topright',
axis.text.x = element_text(angle=45, hjust=0.8),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=0.8),
strip.text = element_text(hjust = 0))
subs_tidy <- subs_all %>% pivot_longer(sadness_head_pos_color:hedonic_feet_pos_color, names_to="task", values_to="prop_coloured") %>%
mutate(task = str_replace(task, 'upper_torso', 'uppertorso'),
task = str_replace(task, 'lower_torso', 'lowertorso')) %>%
separate(task, into=c('condition','area','direction',NA)) %>%
pivot_wider(names_from = direction, values_from = prop_coloured)  %>%
mutate(area = factor(area,
levels=c('head','shoulders','arms','hands', 'uppertorso','lowertorso','legs','feet'),
labels=c('Head','Shoulders', 'Arms','Hands', 'Upper torso','Lower torso','Legs','Feet')))
pain_full <- subs_tidy %>%  filter(condition %in% c('currpain', 'chronpain')) %>%
mutate(condition = factor(condition, levels=c('currpain','chronpain'), labels = c('current', 'chronic'))) %>%
select(-c(neg, total))
pain_summary <- pain_full %>% group_by(condition, area, group) %>% summarise(mean = mean(pos, na.rm=T),
sd = sd(pos, na.rm=T),
num_obs = sum(!is.na(pos))) %>%
mutate(se = sd/sqrt(num_obs))
## visualise emotions
emo_full <- subs_tidy %>% filter(condition %in% c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')) %>%
mutate(condition = factor(condition, levels=c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')))
emo_summary <- emo_full %>% group_by(condition, area, group) %>% summarise(mean_pos = mean(pos, na.rm=T),
sd_pos = sd(pos, na.rm=T),
mean_neg = mean(neg, na.rm=T),
sd_neg = sd(neg, na.rm=T),
mean_total = mean(total, na.rm=T),
sd_total = sd(total, na.rm=T),
num_obs = sum(!is.na(total))) %>%
mutate(se_pos = sd_pos/sqrt(num_obs),
se_neg = sd_neg/sqrt(num_obs),
se_total = sd_total/sqrt(num_obs))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=0.8),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=0.5),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=1),
strip.text = element_text(hjust = 0))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=1),
strip.text = element_text(hjust = 0))
ggsave('/Users/juusu53/Documents/projects/kipupotilaat/figures/emotion_ROI_helsinki_controls_facet_area_new.png',
width = 16, height = 8, dpi=300)
View(subs_tidy)
subs_tidy <- subs_all %>% pivot_longer(sadness_head_pos_color:hedonic_feet_pos_color, names_to="task", values_to="prop_coloured") %>%
mutate(task = str_replace(task, 'upper_torso', 'uppertorso'),
task = str_replace(task, 'lower_torso', 'lowertorso')) %>%
separate(task, into=c('condition','area','direction',NA)) %>%
pivot_wider(names_from = direction, values_from = prop_coloured)  %>%
mutate(area = factor(area,
levels=c('head','shoulders','arms','hands', 'uppertorso','lowertorso','legs','feet'),
labels=c('Head','Shoulders', 'Arms','Hands', 'Upper torso','Lower torso','Legs','Feet'))) %>%
mutate(group= factor(group, levels=c('patient', 'control')))
## visualise emotions
emo_full <- subs_tidy %>% filter(condition %in% c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')) %>%
mutate(condition = factor(condition, levels=c('sadness', 'happiness', 'anger', 'surprise', 'fear','disgust','neutral')))
emo_summary <- emo_full %>% group_by(condition, area, group) %>% summarise(mean_pos = mean(pos, na.rm=T),
sd_pos = sd(pos, na.rm=T),
mean_neg = mean(neg, na.rm=T),
sd_neg = sd(neg, na.rm=T),
mean_total = mean(total, na.rm=T),
sd_total = sd(total, na.rm=T),
num_obs = sum(!is.na(total))) %>%
mutate(se_pos = sd_pos/sqrt(num_obs),
se_neg = sd_neg/sqrt(num_obs),
se_total = sd_total/sqrt(num_obs))
emo_summary %>%
ggplot(aes(x=condition, y=mean_total, col=group, fill=group, group=group)) +
geom_jitter(data=emo_full, aes(x=condition, y=total, colour=group), alpha=0.3, position=position_jitterdodge()) +
geom_errorbar(aes(ymin=mean_total-se_total, ymax=mean_total+se_total), color='black',
position=position_dodge(), width=.2) +
geom_point(position = position_dodge(), size=2) +
geom_line(position=position_dodge(), size=2)+
ylab('Proportion of body marked as activation or deactivation') +
xlab('Emotion') +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))+
facet_wrap(~area, nrow=2) +
theme_classic() +
theme(text = element_text(size=20),
strip.background = element_blank(),
legend.justification = "top",
axis.text.x = element_text(angle=45, hjust=1),
strip.text = element_text(hjust = 0))
ggsave('/Users/juusu53/Documents/projects/kipupotilaat/figures/emotion_ROI_helsinki_controls_facet_area_new.png',
width = 16, height = 8, dpi=300)
