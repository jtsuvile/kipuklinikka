coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.3, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group),
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.3)) +
expand_limits(x = 5.25) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.3, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.3)) +
expand_limits(x = 5.25) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.3, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
expand_limits(x = 5.25) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
expand_limits(x = 5.25) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = as.numeric(emotion)-0.2, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.1,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.1)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.3)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.4)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.3), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.5), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
#coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.5), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5)) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.5), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5), notch=TRUE) +
scale_x_discrete(limits=c('fear','happiness','sadness', 'anger','disgust','surprise','neutral')) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.5), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5), notch=TRUE) +
scale_x_discrete(limits=t(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.5), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.3,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.5), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.4,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic()
g
g <- ggplot(data = summarized_total, aes(y = coloured, x = emotion, fill = group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.4,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = coloured, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(data=data_long, aes(y = total, x = emotion, col=group),
position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.4,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = coloured, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.4,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(data=data_long, aes(y = total, x = emotion, col=group), width=0.4,
outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
## total pixels
data_long <- subs_all_big %>%
select(subid, sex, batch, sadness_pos_color:neutral_total) %>% select(-contains("pain")) %>% select(-contains("sensitivity")) %>%
pivot_longer(sadness_pos_color:neutral_total, names_to = "emotion", values_to="prop_coloured") %>%
separate(emotion, into=c("emotion", "type", NA)) %>% pivot_wider(names_from=type, values_from=prop_coloured) %>%
mutate(emotion = factor(emotion), subid = factor(subid), batch = factor(batch, levels=c('patient', 'control'))) %>%
rename(group = batch)
outliers_total_pixels <- data_long %>% group_by(group, emotion) %>% identify_outliers(total)
data_long %>% group_by(group, emotion) %>% shapiro_test(total)
ggqqplot(data_long, "total", ggtheme = theme_bw()) +
facet_grid(emotion ~ group)
# activations and deactivations
basic_anova <- lm(total ~ group * emotion, data = data_long)
summarized_total <- data_long %>% group_by(emotion, group) %>%
summarise(coloured = mean(total, na.rm=T), sd = sd(total, na.rm=T), n = n(), na_nums= sum(is.na(total))) %>%
mutate(se = sd/sqrt(n))
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
# scale_color_brewer(palette = "Dark2") +
# scale_fill_brewer(palette = "Dark2") +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(xlab='Proportion of body area coloured') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
?labs
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(x='Proportion of body area coloured') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured', x='') +
#coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .5, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g <- ggplot(data = data_long, aes(y = total, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g
g2 <- ggplot(data = data_long, aes(y = pos, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured as activated', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y='Proportion of body area coloured as deactivated', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g2 <- ggplot(data = data_long, aes(y = pos, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
g3 <- ggplot(data = data_long, aes(y = neg, x = emotion, fill = group, col=group)) +
# geom_half_violin(data=data_long, aes(y=total, x=emotion, fill=group),
#                  position = position_nudge(x = .2, y = 0), alpha = .8, side = "r") +
geom_point(position = position_jitterdodge(jitter.width = .15, dodge.width = 0.6), size = .9, alpha = 0.8) +
geom_boxplot(width=0.4, outlier.shape = NA, alpha = 0.5, position = position_dodge(width=0.6), notch=TRUE) +
scale_x_discrete(limits=rev(c('fear','happiness','sadness', 'anger','disgust','surprise','neutral'))) +
expand_limits(x = 5.25) +
labs(y=' ', x='') +
coord_flip() +
theme_classic() +
theme(text = element_text(size=20))
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"), font.label = c(size = 20),
hjust = c(-0.3,-0.5,-0.35), vjust = 1,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls.png',
width = 1300, height = 500, pointsize = 30)
ggarrange(g, g2, g3,
labels = c("activations and deactivations", "activations", "deactivations"), font.label = c(size = 20),
hjust = c(-0.3,-0.5,-0.35), vjust = 1,
ncol = 3, nrow = 1, common.legend = TRUE) %>%
ggexport(filename = '/Users/juusu53/Documents/projects/kipupotilaat/figures/n_colored_pixels_patients_and_controls_dotandbox.png',
width = 1300, height = 500, pointsize = 30)
